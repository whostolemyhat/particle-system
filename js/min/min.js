function Particle(){this.scale=1,this.x=0,this.y=0,this.radius=20,this.colour="#000",this.velocityX=0,this.velocityY=0,this.scaleSpeed=.5,this.update=function(ms){this.scale-=this.scaleSpeed*ms/1e3,this.scale<=0&&(this.scale=0),this.x+=this.velocityX*ms/1e3,this.y+=this.velocityY*ms/1e3},this.draw=function(ctx){ctx.save(),ctx.translate(this.x,this.y),ctx.scale(this.scale,this.scale),ctx.beginPath(),ctx.arc(0,0,this.radius,0,2*Math.PI,!0),ctx.closePath(),ctx.fillStyle=this.colour,ctx.fill(),ctx.restore()}}function ParticleSystem(ctx){this.particles=[],this.createExplosion=function(x,y,colour){for(var minSize=3,maxSize=18,count=20,minSpeed=70,maxSpeed=280,minScaleSpeed=2,maxScaleSpeed=6,angle=0;360>angle;angle+=Math.round(360/count)){var particle=new Particle;particle.x=x,particle.y=y,particle.radius=Utility.randomNumber(minSize,maxSize),particle.colour=Utility.alterShade(colour,parseFloat(Utility.randomNumber(-1,1)).toFixed(2)),particle.scaleSpeed=Utility.randomNumber(minScaleSpeed,maxScaleSpeed);var speed=Utility.randomNumber(minSpeed,maxSpeed);particle.velocityX=speed*Math.cos(angle*Math.PI/180),particle.velocityY=speed*Math.sin(angle*Math.PI/180),this.particles.push(particle)}},this.update=function(frameDelay){ctx.fillStyle="#fff",ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);for(var i=0;i<this.particles.length;i++){var particle=this.particles[i];particle.update(frameDelay),particle.draw(ctx)}}}function init(){canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),ctx.canvas.width=window.innerWidth,ctx.canvas.height=window.innerHeight;var mousePos={x:canvas.width/2,y:canvas.height/2},colour="#52ef1d",particleSystem=new ParticleSystem(ctx);canvas.addEventListener("mousedown",function(event){mousePos=Utility.getMouseClick(canvas,event),particleSystem.createExplosion(mousePos.x,mousePos.y,colour)},!1),function animloop(){requestAnimFrame(animloop);var now=(new Date).getTime(),dt=now-(time||now);time=now,particleSystem.update(dt)}()}var Utility={randomNumber:function(min,max){return min+Math.random()*(max-min)},alterShade:function(hex,lum){hex=String(hex).replace(/[^0-9a-f]/gi,""),hex.length<6&&(hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]),lum=lum||0;var c,i,rgb="#";for(i=0;3>i;i++)c=parseInt(hex.substr(2*i,2),16),c=Math.round(Math.min(Math.max(0,c+c*lum),255)).toString(16),rgb+=("00"+c).substr(c.length);return rgb},getMouseClick:function(canvas,event){var rect=canvas.getBoundingClientRect();return{x:event.clientX-rect.top,y:event.clientY-rect.left}}},ctx,canvas,time;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}(),window.onload=init;